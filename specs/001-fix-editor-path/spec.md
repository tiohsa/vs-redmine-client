# Feature Specification: 編集ファイルパス固定設定

**Feature Branch**: `001-fix-editor-path`  
**Created**: 2025-12-28  
**Status**: Draft  
**Input**: User description: "チケット選択時に開く編集ファイルのパスを固定にするためにsettingsでしていできるようにする"

## Clarifications

### Session 2025-12-28

- Q: 設定値はディレクトリ指定か、ファイルパス指定か？ → A: ディレクトリパスのみ指定し、既存のファイル名規則で保存する
- Q: 設定値のパス解釈は？ → A: OSの絶対パスとして解釈する
- Q: 設定パスが不正な場合の挙動は？ → A: エラー通知して従来の場所へフォールバックする

## User Scenarios & Testing *(mandatory)*

**Constitution reminder**: Unit tests are mandatory and must be defined before
implementation. Ensure scenarios can be covered by unit tests.

### User Story 1 - 編集ファイルの保存先を設定できる (Priority: P1)

ユーザーは設定で編集ファイルの保存先パスを指定し、チケット選択時にその場所へ編集ファイルが作成される。

**Why this priority**: 編集ファイルの場所が安定しないと管理やバックアップが難しくなるため。

**Independent Test**: 設定されたパスに編集ファイルが作成されることを確認できる。

**Acceptance Scenarios**:

1. **Given** 編集ファイルの保存先パスを設定している, **When** チケットを選択する, **Then** 指定したパスに編集ファイルが作成される
2. **Given** 既に指定パスに同名ファイルがある, **When** チケットを選択する, **Then** 既存ファイルを再利用して編集を継続できる

---

### User Story 2 - 設定未指定時は従来動作を維持する (Priority: P2)

ユーザーは設定を変更していない場合、これまで通りの場所に編集ファイルが作成される。

**Why this priority**: 既存ユーザーへの影響を最小化するため。

**Independent Test**: 設定なしでも従来の保存場所で編集できることを確認できる。

**Acceptance Scenarios**:

1. **Given** 編集ファイルの保存先パスを未設定, **When** チケットを選択する, **Then** 従来の保存場所に編集ファイルが作成される

---

### Edge Cases

- 設定されたパスが存在しない場合はエラー通知し、従来の場所にフォールバックする
- 設定されたパスに書き込み権限がない場合はエラー通知し、従来の場所にフォールバックする

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは編集ファイルの保存先パスを設定で指定できなければならない
- **FR-002**: 指定されたパスが有効な場合、チケット選択時に編集ファイルをそのパスに作成しなければならない
- **FR-003**: 保存先パスが未設定の場合、従来の保存場所を使用しなければならない
- **FR-004**: 保存先パスが存在しない、または書き込みできない場合はエラーを通知し、従来の保存場所にフォールバックしなければならない
- **FR-005**: 既存ファイルがある場合は再利用し、編集内容を維持しなければならない
- **FR-006**: 設定値はディレクトリパスのみとし、ファイル名は既存の規則で決定しなければならない
- **FR-007**: 設定値はOSの絶対パスとして解釈しなければならない

### Key Entities *(include if feature involves data)*

- **編集ファイル保存先設定**: ユーザーが指定するパス文字列
- **保存先ディレクトリ**: 設定で指定する編集ファイルの格納ディレクトリ
- **編集ファイル**: チケット選択時に作成される編集用ファイル

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 指定パスで編集ファイルが作成される成功率が99%以上
- **SC-002**: 設定未指定時の従来動作の維持率が100%
- **SC-003**: 無効なパス指定時のフォールバック成功率が100%
- **SC-004**: チケット選択から編集画面表示までの体感待ち時間が1秒以内

## Assumptions

- 設定値はユーザー単位で保持される
- パスはローカルファイルシステム上のディレクトリを指す
